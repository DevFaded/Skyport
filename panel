#!/bin/bash

ascii_art="
 _____         _          _ 
|  ___|_ _  __| | ___  __| |
| |_ / _` |/ _` |/ _ \/ _` |
|  _| (_| | (_| |  __/ (_| |
|_|  \__,_|\__,_|\___|\__,_|
"

RED='\033[0;31m'
CYAN='\033[0;36m'
NC='\033[0m'

clear

if [ "$EUID" -ne 0 ]; then
  echo -e "${RED}Please run this script as root.${NC}"
  exit 1
fi

echo -e "${CYAN}$ascii_art${NC}"

echo -e "${CYAN}* Installing Dependencies...${NC}"
apt update && apt install -y curl software-properties-common git

echo -e "${CYAN}* Setting up Node.js 20.x...${NC}"
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs

echo -e "${CYAN}* Cloning and Installing Panel5...${NC}"
git clone https://github.com/achul123/panel5.git panel5
cd panel5 || { echo -e "${RED}Failed to enter panel5 directory.${NC}"; exit 1; }

npm install

echo -e "${CYAN}* Running Database Seed & Create User...${NC}"
npm run seed
npm run createUser

echo -e "${CYAN}* Installing PM2 & Starting Skyport...${NC}"
npm install -g pm2 --unsafe-perm
pm2 start index.js --name skyport

clear
echo -e "${CYAN}* Skyport Installed and Started on Port 3001${NC}"
echo -e "${CYAN}* Made by Faded${NC}"
